<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>پنل ایجاد پروژه</title>
  <link rel="stylesheet" href="admin-create-project.css">
</head>
<body>
  <header class="page-header">
    <div class="header-top-bar">
      <h1 id="page-title">پنل ایجاد پروژه</h1>
      <a href="admin-dashboard.html" id="back-to-dashboard" class="back-link" hidden>← بازگشت به داشبورد</a>
    </div>
  </header>

  <main class="main-wrap">
    <div id="loading-overlay" class="loading-overlay" role="status" aria-live="polite" aria-busy="false" hidden>
      <div class="loading-overlay-content">
        <div class="loading-spinner" aria-hidden="true"></div>
        <p class="loading-overlay-text">در حال ثبت اطلاعات، لطفاً صبر کنید...</p>
      </div>
    </div>
    <div id="global-error" class="alert alert-error" role="alert" aria-live="polite" hidden>
      <div class="alert-content"></div>
      <div id="error-retry-actions" class="alert-actions" hidden></div>
      <details id="error-technical-details" class="error-technical-details" hidden>
        <summary>جزئیات فنی</summary>
        <pre id="error-technical-pre"></pre>
      </details>
    </div>
    <div id="success-banner" class="success-banner" role="status" aria-live="polite" hidden></div>
    <div id="success-panel" class="success-panel" role="status" aria-live="polite" hidden>
      <h2 class="success-panel-title">✅ پروژه شما در ویترین ایجاد شد</h2>
      <p class="success-panel-text">می‌توانید برای مشاهده به لینک زیر بروید:</p>
      <div class="success-panel-actions">
        <a id="btn-view-showcase" href="https://b2wall.darkube.app/" target="_blank" rel="noopener noreferrer" class="btn btn-primary">مشاهده ویترین</a>
        <a id="btn-back-dashboard" href="admin-dashboard.html" class="btn btn-secondary" hidden>بازگشت به داشبورد</a>
        <button type="button" id="btn-create-new" class="btn btn-secondary">ایجاد پروژه جدید</button>
      </div>
    </div>
    <div id="summary-card" class="summary-card-wrap" hidden></div>

    <form id="create-project-form" class="create-form" novalidate aria-busy="false">
      <!-- مالک پروژه: برای حالت SELF_SERVICE مخفی می‌شود و از نشست گرفته می‌شود -->
      <section id="owner-section" class="form-section">
        <h2 class="form-section-title">مالک پروژه</h2>
        <div class="form-row">
          <label for="owner-phone">شماره موبایل <span class="required">*</span></label>
          <input type="text" id="owner-phone" name="owner_phone" required
                 placeholder="۰۹۱۲۰۰۰۰۰۰۰" autocomplete="tel" inputmode="tel">
          <span class="field-error" id="owner-phone-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="owner-full-name">نام و نام خانوادگی <span class="required">*</span></label>
          <input type="text" id="owner-full-name" name="owner_full_name" required
                 placeholder="نام مالک" autocomplete="name">
          <span class="field-error" id="owner-full-name-error" role="alert"></span>
        </div>
      </section>

      <!-- پروژه -->
      <section class="form-section">
        <h2 class="form-section-title">پروژه</h2>
        <div class="form-row">
          <label for="project-title">عنوان <span class="required">*</span></label>
          <input type="text" id="project-title" name="project_title" required
                 value="تأمین مالی جهت "
                 placeholder="تأمین مالی جهت ساخت واحد مسکونی">
          <span class="field-error" id="project-title-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-status">وضعیت <span class="required">*</span></label>
          <select id="project-status" name="project_status" required>
            <option value="REVIEW">در حال کارشناسی</option>
            <option value="FUNDING">در حال جذب سرمایه</option>
            <option value="COMPLETED">تکمیل‌شده</option>
          </select>
          <span class="field-error" id="project-status-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-monthly-profit-percent">سود ماهانه (درصد) <span class="required">*</span></label>
          <input type="text" id="project-monthly-profit-percent" name="project_monthly_profit_percent"
                 required min="1" max="100" step="0.01" placeholder="۱۸" inputmode="decimal" autocomplete="off">
          <span class="field-error" id="project-monthly-profit-percent-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-duration-months">مدت (ماه) <span class="required">*</span></label>
          <input type="text" id="project-duration-months" name="project_duration_months"
                 required min="1" max="120" placeholder="۱۲" inputmode="numeric" autocomplete="off">
          <span class="field-error" id="project-duration-months-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-profit-payout-interval-days">فاصله پرداخت سود (روز) <span class="required">*</span></label>
          <input type="text" id="project-profit-payout-interval-days" name="project_profit_payout_interval_days"
                 required min="1" placeholder="۹۰" inputmode="numeric" autocomplete="off">
          <span class="field-error" id="project-profit-payout-interval-days-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-principal-payout-interval-days">فاصله پرداخت اصل سرمایه (روز) <span class="required">*</span></label>
          <input type="text" id="project-principal-payout-interval-days" name="project_principal_payout_interval_days"
                 required min="1" placeholder="۳۶۰" inputmode="numeric" autocomplete="off">
          <span class="field-error" id="project-principal-payout-interval-days-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label>نوع ضمانت <span class="required">*</span></label>
          <div id="guarantee-checkboxes" class="guarantee-checkboxes" role="group" aria-label="نوع ضمانت"></div>
          <div id="guarantee-chips" class="guarantee-chips" hidden></div>
          <span class="field-error" id="project-guarantee-type-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-funded-amount-toman">مبلغ تأمین‌شده (تومان)</label>
          <input type="text" id="project-funded-amount-toman" name="project_funded_amount_toman"
                 value="۰" min="0" disabled title="برای پروژه جدید همیشه صفر است">
          <div id="funded-amount-readable" class="amount-readable" hidden>
            <span id="funded-amount-formatted"></span>
            <span id="funded-amount-words"></span>
          </div>
          <span class="field-hint">غیرفعال؛ برای پروژه‌های جدید همیشه صفر است.</span>
        </div>
        <div class="form-row">
          <label for="project-required-amount-toman">مبلغ مورد نیاز (تومان) <span class="required">*</span></label>
          <input type="text" id="project-required-amount-toman" name="project_required_amount_toman"
                 required min="0" placeholder="2000000000" inputmode="numeric" autocomplete="off">
          <div id="required-amount-readable" class="amount-readable" hidden aria-live="polite">
            <span id="required-amount-formatted"></span>
            <span class="amount-words-line"><span class="amount-words-label">به حروف:</span> <span id="required-amount-words"></span></span>
          </div>
          <span class="field-error" id="project-required-amount-toman-error" role="alert"></span>
        </div>
        <div class="form-row">
          <label for="project-visibility">وضعیت انتشار <span class="required">*</span></label>
          <select id="project-visibility" name="project_visibility" required>
            <option value="PUBLISHED">منتشر شده</option>
            <option value="UNPUBLISHED">منتشر نشده</option>
          </select>
          <span class="field-hint">در صورت انتخاب منتشر شود، پروژه در ویترین نمایش داده خواهد شد.</span>
          <span class="field-error" id="project-visibility-error" role="alert"></span>
        </div>
      </section>

      <!-- تصویر پروژه -->
      <section class="form-section">
        <h2 class="form-section-title">تصویر پروژه</h2>
        <div class="form-row">
          <label for="project-image">تصویر <span class="required">*</span></label>
          <input type="file" id="project-image" name="project_image" accept="image/jpeg,image/png,image/webp" required>
          <span class="field-hint">حداکثر ۳ مگابایت. فرمت: JPG، PNG، WebP. حداقل ابعاد: ۴۰۰×۳۰۰</span>
          <span class="field-error" id="project-image-error" role="alert"></span>
        </div>
        <div id="image-preview-wrap" class="image-preview-wrap" hidden>
          <img id="image-preview" src="" alt="پیش‌نمایش" class="image-preview">
        </div>
      </section>

      <div class="form-actions">
        <p id="progress-text" class="progress-text" aria-live="polite" hidden></p>
        <button type="submit" id="submit-btn" class="btn btn-primary">ایجاد پروژه</button>
        <button type="reset" id="reset-btn" class="btn btn-secondary">پاک کردن</button>
      </div>
    </form>
  </main>

  <footer class="footer">پنل ایجاد پروژه — B2Wall</footer>

  <script src="admin-create-project.js"></script>
</body>
</html>
